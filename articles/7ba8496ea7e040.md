---
title: "勝率5割になるはずの対戦ゲームでありえないほどの連敗が起きる事象をRubyで検証する"
emoji: "🐥"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["Ruby", "確率"]
published: true
---

ウデマエに関係なく勝率5割に収束すると言われているゲームで、びっくりするほど連勝するときと、ありえないほど連敗するときがある。ありえないほど連敗したときは勝率5割のはずでこんな負けが続くなんて意図的に懲罰をくらっているとしか思えなくなったり、こんなに不幸が続くともう死ぬんじゃないかと思えてくる。

そこで1日20回を3年ほどプレイし、勝率が50%だったときの連勝・連敗の数をRubyのコードでシミュレートしてみる。

```ruby
play_per_day = 20 # 1日20回を
days = 365 * 3    # 3年ぐらい遊んでいる
win_rate = 0.5    # 勝率

n = play_per_day * days
v = n.times.map { rand >= win_rate }
v = v.chunk(&:itself).tally
v = v.sort_by { |(_, a), _| -a.size }
puts v.map { |(k, a), c| "%2d連%s %4d回" % [a.size, k ? "勝" : "敗", c] }
# >> 18連敗    1回
# >> 13連勝    2回
# >> 12連勝    1回
# >> 12連敗    2回
# >> 11連勝    7回
# >> 11連敗    2回
# >> 10連勝   10回
# >> 10連敗    7回
# >>  9連勝   13回
# >>  9連敗   13回
# >>  8連敗   33回
# >>  8連勝   20回
# >>  7連勝   45回
# >>  7連敗   45回
# >>  6連敗   74回
# >>  6連勝   83回
# >>  5連敗  163回
# >>  5連勝  164回
# >>  4連勝  334回
# >>  4連敗  371回
# >>  3連敗  643回
# >>  3連勝  674回
# >>  2連勝 1358回
# >>  2連敗 1304回
# >>  1連勝 2769回
# >>  1連敗 2822回
```

これでわかったことは3年もやってれば13連勝することもあれば18連敗することもあって、それは急に上達したり懲罰をくらったりしているわけではないということだった。
