---
title: "[Rust] ãƒ™ã‚¯ãƒˆãƒ«ãƒ©ã‚¤ãƒ–ãƒ©ãƒª glam ã®ä½œã‚Šè¾¼ã¿ãŒã‚„ã°ã‹ã£ãŸ"
emoji: "ðŸ¦”"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Rust", "glam", "nannou"]
published: false
---

## ã¯ã˜ã‚ã«

[nannou](https://docs.rs/nannou) ã§ä½¿ã‚ã‚Œã¦ã„ã‚‹ [glam](https://docs.rs/glam) ã¨ã„ã†ãƒ™ã‚¯ãƒˆãƒ«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä½œã‚Šè¾¼ã¿ãŒã™ã•ã¾ã˜ã‹ã£ãŸã®ã§ã€2Dã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’æ‰±ã†ã¨ãã«ä¸»ã«ä½¿ã†ã¨æ€ã‚ã‚Œã‚‹ Vec2 åž‹ã‚’ä¸­å¿ƒã«(è‡ªåˆ†ãŒä½¿ã„æ–¹ã‚’è¦šãˆã‚‹ãŸã‚ã«)ä½¿ã„æ–¹ã‚’ç´¹ä»‹ã™ã‚‹ã€‚

## åŸºæœ¬çš„ãªç”Ÿæˆæ–¹æ³•

```rust
vec2(2.0, 3.0)        // => Vec2(2.0, 3.0)
Vec2::new(2.0, 3.0)); // => Vec2(2.0, 3.0)

// å…¨è¦ç´ ã‚’åŒã˜å€¤ã§ç”Ÿæˆã™ã‚‹
Vec2::splat(2.0)      // => Vec2(2.0, 2.0)
```

## ä»–ã®åž‹ã‹ã‚‰ã®ç”Ÿæˆ

```rust
// from ã¯ä¼¼ãŸã‚ˆã†ãªåž‹ãªã‚‰ãªã‚“ã§ã‚‚ã„ã‘ã‚‹
Vec2::from((2.0, 3.0))               // => Vec2(2.0, 3.0)
Vec2::from([2.0, 3.0])               // => Vec2(2.0, 3.0)
Vec2::from(vec2(2.0, 3.0))           // => Vec2(2.0, 3.0)
Vec2::from(Vec3::new(2.0, 3.0, 4.0)) // => Vec2(2.0, 3.0)

// é…åˆ—ã®å‚ç…§ã‹ã‚‰ç”Ÿæˆ
Vec2::from_slice(&[2.0, 3.0])        // => Vec2(2.0, 3.0)
```

## åž‹å¤‰æ›ç³»
```rust
// 3æ¬¡å…ƒã®ãƒ™ã‚¯ãƒˆãƒ«ã«æ‹¡å¼µã™ã‚‹
vec2(2.0, 3.0).extend(4.0)     // => Vec3(2.0, 3.0, 4.0)

// é€†ã«3æ¬¡å…ƒã®ãƒ™ã‚¯ãƒˆãƒ«ã‹ã‚‰2æ¬¡å…ƒã«æˆ»ã™
vec3(2.0, 3.0, 4.0).truncate() // => Vec2(2.0, 3.0)

// ç²¾åº¦ã‚’å¤‰æ›´ã™ã‚‹ (D=f64 I=i32 U=u32)
vec2(2.0, 3.0).as_f64()        // => DVec2(2.0, 3.0)
vec2(2.0, 3.0).as_i32()        // => IVec2(2, 3)
vec2(2.0, 3.0).as_u32()        // => UVec2(2, 3)

// ãŸã ã®é…åˆ—ã«æˆ»ã™
vec2(2.0, 3.0).to_array()      // => [2.0, 3.0]

// æ–‡å­—åˆ—åŒ–
vec2(2.0, 3.0).to_string()     // => "[2, 3]"
```

## ã‚ã‚‹ã‚ã‚‹æ¼”ç®—
```rust
        // vec2(2.0, 3.0).add(vec2(4.0, 5.0))     // => Vec2(3.0, 4.0)
vec2(2.0, 3.0) + 1.0     // => Vec2(3.0, 4.0)
vec2(2.0, 3.0) - 1.0     // => Vec2(1.0, 2.0)
vec2(2.0, 3.0) * 2.0     // => Vec2(4.0, 6.0)
vec2(2.0, 3.0) / 2.0     // => Vec2(1.0, 1.5)

vec2(2.0, 3.0) + vec2(4.0, 5.0) // => Vec2(6.0, 8.0)
vec2(2.0, 3.0) - vec2(4.0, 5.0) // => Vec2(-2.0, -2.0)
vec2(2.0, 3.0) * vec2(4.0, 5.0) // => Vec2(8.0, 15.0)
vec2(2.0, 3.0) / vec2(4.0, 5.0) // => Vec2(0.5, 0.6)

vec2(2.0, 3.0).powf(2.0) // => Vec2(4.0, 9.0)

vec2(2.0, 3.0).exp()     // => Vec2(7.389056, 20.085537)
-vec2(2.0, 3.0)          // => Vec2(-2.0, -3.0)
```

## å¾®è£œæ­£
```rust
vec2(2.4, 3.5).floor() // => Vec2(2.0, 3.0)
vec2(2.4, 3.5).ceil()  // => Vec2(3.0, 4.0)
vec2(2.4, 3.5).round() // => Vec2(2.0, 4.0)
```

## ç¯„å›²è£œæ­£
```rust
vec2(2.0, 5.0).clamp(vec2(3.0, 3.0), vec2(4.0, 4.0))   // => Vec2(3.0, 4.0)
```

## æˆåˆ†ã‚’èª¿æ•´ã—ãŸå¤‰æ›
```rust
        // çµ¶å¯¾å€¤ã«ã™ã‚‹
vec2(-2.0, -3.0).abs() // => Vec2(2.0, 3.0)

        // ç¬¦å·ã ã‘ã«ã™ã‚‹
vec2(-2.0, 3.0).signum() // => Vec2(-1.0, 1.0)

        // æˆåˆ†ã‹ã‚‰æˆåˆ†ã® floor ã‚’å¼•ã
        // -2.4 - -3 â†’ 0.6
        //  5.8 -  5 â†’ 0.8
vec2(-2.4, 5.8).fract() // => Vec2(0.5999999, 0.8000002)
```

## æœ‰é™ãƒ»ç„¡é™(NAN?)
```rust
vec2(2.0, 3.0).is_finite() // => true

vec2(2.0, f32::NAN).is_nan()      // => true
vec2(2.0, f32::NAN).is_nan_mask() // => BVec2(0x0, 0xffffffff)
```

## æœ€å¤§æœ€å°
```rust
        // å˜ã«æˆåˆ†ãŒå¯¾è±¡
vec2(2.0, 3.0).min_element() // => 2.0
vec2(2.0, 3.0).max_element() // => 3.0
```

## æœ€å¤§æœ€å°ã‚’å–ã£ã¦åˆæˆ
```rust
        // (x.max(other.x), y.max(other.y))
        // (x.min(other.x), y.min(other.y))
vec2(1.0, 2.0).max(vec2(3.0, 1.0)) // => Vec2(3.0, 2.0)
vec2(1.0, 2.0).min(vec2(3.0, 1.0)) // => Vec2(1.0, 1.0)
```

## æ¯”è¼ƒ
```rust
        // å°æ•°ã®èª¤å·®ãŒã‚ã‚‹ãŸã‚æ•´æ•°ã®ã¨ãã ã‘ã«ã—ãŸæ–¹ãŒã‚ˆã„
vec2(2.0, 3.0) == vec2(2.0, 3.0) // => true
vec2(2.0, 3.0) != vec2(4.0, 5.0) // => true
        // å¤§ãªã‚Šãƒ»å°ãªã‚Šã¯ã§ããªã„

        // è¨±å®¹ã™ã‚‹èª¤å·®ã‚’æŒ‡å®šã§ãã‚‹
vec2(2.0, 3.0).abs_diff_eq(vec2(2.0, 3.1), 0.09) // => false
vec2(2.0, 3.0).abs_diff_eq(vec2(2.0, 3.1), 0.1)  // => true
```

## æ¯”è¼ƒã—ãŸçµæžœã‚’ mask ã§è¿”ã™
```rust
vec2(2.0, 3.0).cmpeq(vec2(2.0, 3.0)) // => BVec2(0xffffffff, 0xffffffff)
vec2(2.0, 3.0).cmpne(vec2(2.0, 3.0)) // => BVec2(0x0, 0x0)
vec2(2.0, 3.0).cmpge(vec2(2.0, 3.0)) // => BVec2(0xffffffff, 0xffffffff)
vec2(2.0, 3.0).cmpgt(vec2(2.0, 3.0)) // => BVec2(0x0, 0x0)
vec2(2.0, 3.0).cmple(vec2(2.0, 3.0)) // => BVec2(0xffffffff, 0xffffffff)
vec2(2.0, 3.0).cmplt(vec2(2.0, 3.0)) // => BVec2(0x0, 0x0)
```

## é•·ã•ãƒ»è·é›¢
```rust
        // sqrt(x**2 + y**2) â†’ sqrt(13) â†’ 3.6
vec2(2.0, 3.0).length() // => 3.6055512

        // length ãŒæœ€ä½Ž 3.7 ä»¥ä¸Šã«ãªã‚‹ã‚ˆã†ã«èª¿æ•´ã—ãŸãƒ™ã‚¯ãƒˆãƒ«ã‚’è¿”ã™
vec2(2.0, 3.0).clamp_length_min(3.7) // => Vec2(2.0523908, 3.078586)

        // length ãŒæœ€å¤§ 4.0 ä»¥ä¸‹ã«ãªã‚‹ã‚ˆã†ã«èª¿æ•´ã—ãŸãƒ™ã‚¯ãƒˆãƒ«ã‚’è¿”ã™
vec2(2.0, 3.0).clamp_length_max(3.5) // => Vec2(1.9414507, 2.9121761)

        // clamp_length_min(3.5) ã¨ clamp_length_max(3.7) ã‚’ä¸€æ‹¬æŒ‡å®š
vec2(2.0, 3.0).clamp_length(3.5, 3.7) // => Vec2(2.0, 3.0)

        // x**2 + y**2 â†’ 2**2 + 3**2 â†’ 13.0
vec2(2.0, 3.0).length_squared() // => 13.0

        // 1.0 / length
vec2(2.0, 3.0).length_recip() // => 0.2773501

        // å¼•æ•°ã‚’åŽŸç‚¹ã¨è€ƒãˆã‚‹ã€‚ã‚ã¨ã¯ä¸Šã¨åŒã˜
vec2(10.0, 10.0).distance(vec2(12.0, 13.0))                // => 3.6055512
vec2(10.0, 10.0).distance_squared(vec2(12.0, 13.0))        // => 13.0

```

## æ­£è¦åŒ–
```rust
        // ãƒ€ãƒ¡ãªã‚‰ Vec2(NaN, NaN)
vec2(2.0, 3.0).normalize()                             // => Vec2(0.5547002, 0.8320503)
vec2(0.0, 0.0).normalize()                             // => Vec2(NaN, NaN)

        // ãƒ€ãƒ¡ãªã‚‰ None
vec2(2.0, 3.0).try_normalize()                         // => Some(Vec2(0.5547002, 0.8320503))
vec2(0.0, 0.0).try_normalize()                         // => None

        // ãƒ€ãƒ¡ãªã‚‰ Vec2::ZERO
vec2(2.0, 3.0).normalize_or_zero()                     // => Vec2(0.5547002, 0.8320503)
vec2(0.0, 0.0).normalize_or_zero()                     // => Vec2(0.0, 0.0)

        // æ­£è¦åŒ–ã—ã¦ã‚ã‚‹ï¼Ÿ
vec2(2.0, 3.0).is_normalized()                         // => false
vec2(2.0, 3.0).normalize().is_normalized()             // => true

        // recip ã¯ reciprocal ã®ç•¥ã ã‚ã†ã‹ï¼Ÿ
        // ã€Šç•¥èªžã€‹ã€æ–‡æ³•ã€‘reciprocalï¼ˆç›¸äº’çš„ãªï¼‰
        // (1.0 / x, 1.0 / y)
vec2(2.0, 3.0).recip()                                 // => Vec2(0.5, 0.33333334)
```

## ç·šåž‹è£œå®Œ
## ç¬¬äºŒå¼•æ•°(s)ãŒ 0 ãªã‚‰ self ã§ 1 ãªã‚‰ other ã«ãªã‚‹
## self + (other - self) * s
```rust
vec2(0.0, 0.0).lerp(vec2(4.0, 4.0), -0.5) // => Vec2(-2.0, -2.0)
vec2(0.0, 0.0).lerp(vec2(4.0, 4.0), 0.0)  // => Vec2(0.0, 0.0)
vec2(0.0, 0.0).lerp(vec2(4.0, 4.0), 0.5)  // => Vec2(2.0, 2.0)
vec2(0.0, 0.0).lerp(vec2(4.0, 4.0), 1.0)  // => Vec2(4.0, 4.0)
vec2(0.0, 0.0).lerp(vec2(4.0, 4.0), 1.5)  // => Vec2(6.0, 6.0)
```

## è§’åº¦
```rust
        // å³ä¸‹ãƒ»çœŸä¸‹ãƒ»å·¦ä¸‹
vec2(2.0, 2.0).angle()   // => 0.7853982
vec2(0.0, 2.0).angle()   // => 1.5707963
vec2(-2.0, 2.0).angle()  // => 2.3561945

        // ã“ã‚Œã¨ä¸€è‡´ã™ã‚‹ã®ã§ angle ã¯å…¨ä½“ã‚’ 2 * PI ã¨ã—ãŸè§’åº¦ã‚’è¿”ã™ã“ã¨ãŒã‚ã‹ã‚‹
PI * 0.25 // => 0.7853982
PI * 0.50 // => 1.5707964
PI * 0.75 // => 2.3561945

        // 2ç‚¹é–“ã®è§’åº¦å·®
        // other.angle - self.angle ç›¸å½“
        // å³ä¸‹.angle_between(çœŸä¸‹) â†’ PI * 0.25 â†’ 0.7853982
vec2(2.0, 2.0).angle_between(vec2(0.0, 2.0))    // => 0.7853982
vec2(0.0, 2.0).angle() - vec2(2.0, 2.0).angle() // => 0.78539807

        // å³å‘ã(2,0)ã‚’æ™‚è¨ˆå›žã‚Šã«90åº¦å›žè»¢ã™ã‚‹ã¨çœŸä¸‹(0,2)ã«ãªã‚‹
vec2(2.0, 0.0).rotate(PI * 0.5).round() // => Vec2(-0.0, 2.0)
```

## æ³•ç·š
## æ³•ç·š(-y, x) 90åº¦å›žè»¢ã—ãŸã‚‚ã®ã¨åŒã˜ã€‚é•·ã•ã‚‚ãã®ã¾ã¾ã€‚
```rust
vec2(2.0, 3.0).perp()                                  // => Vec2(-3.0, 2.0)
vec2(2.0, 3.0).rotate(2.0 * PI * 90.0 / 360.0) // => Vec2(-3.0, 1.9999999)
```

## å†…ç©ãƒ»å¤–ç©
```rust
        // å†…ç©
        // x1 * x2 + y1 * y2
vec2(2.0, 3.0).dot(vec2(4.0, 5.0)) // => 23.0
2 * 4 + 3 * 5                      // => 23

        // å¤–ç©
        // x1 * y2 - x2 * y1
vec2(2.0, 3.0).perp_dot(vec2(4.0, 5.0)) // => -2.0
2 * 5 - 4 * 3                           // => -2

        #[allow(non_snake_case)]
        let A = vec2(3.0, 4.0);
        #[allow(non_snake_case)]
        let B = vec2(6.0, 2.0);

        // æŠ•å½±
        // Aã‚’Bã«æŠ•å½±ã™ã‚‹
        // è¨€ã„æ›¿ãˆã‚‹ã¨Aã‹ã‚‰åž‚ç›´ã«Bã«ç·šã‚’é™ã‚ã—ãŸã¨ãã®äº¤ç‚¹ã‚’è¿”ã™
A.project_onto(B)                        // => Vec2(3.9, 1.3000001)
        // æŠ•å½±å…ˆãŒæ­£è¦åŒ–ã•ã‚Œã„ã‚‹ã¨ãã«ä½¿ãˆã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã§çµæžœã¯åŒã˜
A.project_onto_normalized(B.normalize()) // => Vec2(3.8999999, 1.3)

        // åž‚ç›´æ–¹å‘ã¸ã®æŠ•å½±
        // æŠ•å½±ã—ãŸç‚¹ã‹ã‚‰Aã¸ã®ã¾ã§
        // (A - æŠ•å½±)ãªã®ã§ A - vec2(3.9, 1.3) ã¨ãªã‚‹
A.reject_from(B)                        // => Vec2(-0.9000001, 2.6999998)
A.reject_from_normalized(B.normalize()) // => Vec2(-0.89999986, 2.7)
A - A.project_onto(B)                   // => Vec2(-0.9000001, 2.6999998)
```

## æˆåˆ†ã®å…¥ã‚Œæ›¿ãˆ
```rust
vec2(1.0, 2.0).xy() // => Vec2(1.0, 2.0)
vec2(1.0, 2.0).yx() // => Vec2(2.0, 1.0)
vec2(1.0, 2.0).xx() // => Vec2(1.0, 1.0)
vec2(1.0, 2.0).yy() // => Vec2(2.0, 2.0)

vec2(1.0, 2.0).xxx() // => Vec3(1.0, 1.0, 1.0)
vec2(1.0, 2.0).xxy() // => Vec3(1.0, 1.0, 2.0)
vec2(1.0, 2.0).xyx() // => Vec3(1.0, 2.0, 1.0)
vec2(1.0, 2.0).xyy() // => Vec3(1.0, 2.0, 2.0)
vec2(1.0, 2.0).yxx() // => Vec3(2.0, 1.0, 1.0)
vec2(1.0, 2.0).yxy() // => Vec3(2.0, 1.0, 2.0)
vec2(1.0, 2.0).yyx() // => Vec3(2.0, 2.0, 1.0)
vec2(1.0, 2.0).yyy() // => Vec3(2.0, 2.0, 2.0)

vec2(1.0, 2.0).xxxx() // => Vec4(1.0, 1.0, 1.0, 1.0)
vec2(1.0, 2.0).xxxy() // => Vec4(1.0, 1.0, 1.0, 2.0)
vec2(1.0, 2.0).xxyx() // => Vec4(1.0, 1.0, 2.0, 1.0)
vec2(1.0, 2.0).xxyy() // => Vec4(1.0, 1.0, 2.0, 2.0)
vec2(1.0, 2.0).xyxx() // => Vec4(1.0, 2.0, 1.0, 1.0)
vec2(1.0, 2.0).xyxy() // => Vec4(1.0, 2.0, 1.0, 2.0)
vec2(1.0, 2.0).xyyx() // => Vec4(1.0, 2.0, 2.0, 1.0)
vec2(1.0, 2.0).xyyy() // => Vec4(1.0, 2.0, 2.0, 2.0)
vec2(1.0, 2.0).yxxx() // => Vec4(2.0, 1.0, 1.0, 1.0)
vec2(1.0, 2.0).yxxy() // => Vec4(2.0, 1.0, 1.0, 2.0)
vec2(1.0, 2.0).yxyx() // => Vec4(2.0, 1.0, 2.0, 1.0)
vec2(1.0, 2.0).yxyy() // => Vec4(2.0, 1.0, 2.0, 2.0)
vec2(1.0, 2.0).yyxx() // => Vec4(2.0, 2.0, 1.0, 1.0)
vec2(1.0, 2.0).yyxy() // => Vec4(2.0, 2.0, 1.0, 2.0)
vec2(1.0, 2.0).yyyx() // => Vec4(2.0, 2.0, 2.0, 1.0)
vec2(1.0, 2.0).yyyy() // => Vec4(2.0, 2.0, 2.0, 2.0)
```

## å®šæ•°
```rust
Vec2::ZERO      // => Vec2(0.0, 0.0)
Vec2::ONE       // => Vec2(1.0, 1.0)
Vec2::X         // => Vec2(1.0, 0.0)
Vec2::Y         // => Vec2(0.0, 1.0)
Vec2::AXES      // => [Vec2(1.0, 0.0), Vec2(0.0, 1.0)]
Vec2::default() // => Vec2(0.0, 0.0)
```

## ç¨®é¡ž
```rust
vec2(2.0, 3.0)      // => Vec2(2.0, 3.0)
vec2(2.0, 3.0)      // => Vec2(2.0, 3.0)
ivec2(-2, -3)       // => IVec2(-2, -3)
uvec2(2, 3)         // => UVec2(2, 3)
dvec2(2.0, 3.0)     // => DVec2(2.0, 3.0)
```

## 3æ¬¡å…ƒSIMDå¯¾å¿œç‰ˆ
```rust
Vec3A::new(2.0, 3.0, 4.0)             // => Vec3A(2.0, 3.0, 4.0)
Vec3A::new(2.0, 3.0, 4.0).truncate()  // => Vec2(2.0, 3.0)
```

```rust
BVec2::new(true, false) // => BVec2(0xffffffff, 0x0)

BVec2::new(false, false).bitmask() // => 0
BVec2::new(true, false).bitmask()  // => 1
BVec2::new(false, true).bitmask()  // => 2
BVec2::new(true, true).bitmask()   // => 3

BVec2::new(true, false).any()   // => true
BVec2::new(true, true).all()   // => true

BVec2::new(true, true) & BVec2::new(true, false)   // => BVec2(0xffffffff, 0x0)
BVec2::new(true, false) | BVec2::new(false, true)   // => BVec2(0xffffffff, 0xffffffff)

!BVec2::new(true, false)   // => BVec2(0x0, 0xffffffff)
```

// ã“ã‚Œã¯ãªã‚“ã ã‚ã†ï¼Ÿ
// vec2(2.0, 3.0).point2()    // => [2.0, 3.0]
