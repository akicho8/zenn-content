---
title: "Vue.js で production では呼ばれないと信じていた重い処理が常に呼ばれてた件"
emoji: "🌟"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["Vue"]
published: true
---
下のコードを読み込むと `alert('重い処理')` は呼ばれるだろうか？

```html
<html>
  <head>
    <script src="https://unpkg.com/vue"></script>
  </head>
  <body>
    <div id="app">
      <development-only>
        {{heavy_code()}}
      </development-only>
    </div>
    <script>
      new Vue({
        el: "#app",
        components: {
          "development-only": {
            template: '<div v-if="false"><slot></slot></div>',
          },
        },
        methods: {
          heavy_code() {
            alert('重い処理')
          },
        },
      })
    </script>
  </body>
</html>
```

答え: 呼ばれる

`development-only` コンポーネントではそのなかにくそ重い大量のデバッグ表示を slot で表示するようにしており、production ではそれを省くためにコンポーネント内直下で `v-if="false"` としていた。それから数年後にまさかなと思い、恐る恐る試したら呼ばれたのである。
