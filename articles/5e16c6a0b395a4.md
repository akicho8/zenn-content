---
title: "[Rust] glob クレートを使ってみた"
emoji: "🍣"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["Rust", "glob", "Path"]
published: true
---

## はじめに

ファイルを収集するとき Ruby では `Pathname.glob` があったのに Rust の Path には glob がなくてがっかりだった。
そこで外部クレートを探してみると [glob](https://docs.rs/glob) というそれっぽいのを見つけたので使ってみる。

まずディレクトリ構成は次のようになっている。

```zsh
$ exa -T a
a
└── b
   └── c
      ├── 1.png
      ├── 2.png
      └── 3.PNG
```

ところで── この exa は rust で作られた ls 風のツールで、パスに日本語が含まれていても化けずにツリー表示できるのがありがたい。
普通の tree コマンドは -N をつけないと日本語が表示されなかったりと使い勝手がいまいちだ。
なお、exa は `cargo install exa` でインストールできる。

## 簡単な使い方

```rust:
use glob::glob;

let files = glob("./a/**/*.png")
    .unwrap()
    .map(|e| e.unwrap())
    .collect::<Vec<_>>();

println!("{:?}", files);
// >> ["a/b/c/1.png", "a/b/c/2.png"]
```

`3.PNG` が出てきていないのは大小文字を区別するようになっているから。
試しに `./a/**/*.{png,PNG}` としてもダメだった。


## 大文字小文字の区別をしない

```rust
use glob::glob_with;
use glob::MatchOptions;

let mut options = MatchOptions::new();
options.case_sensitive = false; // false:大小文字の区別をしない

let files = glob_with("./a/**/*.png", options)
    .unwrap()
    .map(|e| e.unwrap())
    .collect::<Vec<_>>();

println!("{:?}", files);
// >> ["a/b/c/1.png", "a/b/c/2.png", "a/b/c/3.PNG"]
```

`case_sensitive` は `true` が初期値なので `false` にすると `.png` で `.PNG` にマッチするようになる。
