---
title: "Ruby/SDL2 ã“ã¨ã¯ã˜ã‚"
emoji: "ğŸ¨"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Ruby", "SDL2", "SDL"]
published: false
---

## ã¯ã˜ã‚ã«

ã„ã¤ã®ã¾ã«ã‹ [Ruby/SDL2](https://rubygems.org/gems/ruby-sdl2/versions/0.1.0?locale=ja) ãŒå…¬é–‹ã•ã‚Œã¦ã„ãŸã®ã§å°å…¥ã®æ‰‹é †ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

`~/src/ruby-sdl2-playground` ã«ä½œæˆã™ã‚‹ä¾‹ã§ã™ã€‚

```sh
#!/bin/sh
cd ~/src
mkdir -p ruby-sdl2-playground
cd ruby-sdl2-playground

bundle init
bundle add ruby-sdl2 --require sdl2 --optimistic
bundle exec ruby -r sdl2 -e "p SDL2"

cat <<'EOF' > main.rb
require "bundler/setup"
Bundler.require(:default)

SDL2.init(SDL2::INIT_EVERYTHING)
window = SDL2::Window.create("(title)", SDL2::Window::POS_CENTERED, SDL2::Window::POS_CENTERED, 640, 480, 0)
window_flags = 0
window_flags |= SDL2::Renderer::Flags::ACCELERATED
window_flags |= SDL2::Renderer::Flags::PRESENTVSYNC
renderer = window.create_renderer(-1, window_flags)

120.times do
  SDL2::Event.poll
  renderer.present
end
EOF

bundle exec ruby main.rb
```

æ¬¡ã®ã‚ˆã†ãªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒ2ç§’è¡¨ç¤ºã•ã‚ŒãŸã‚‰æˆåŠŸã§ã™ã€‚

![simple_window.png](/images/7170a5dc60c97b/simple_window.png)

## ä½•ã‹å‹•ã‹ã—ã¦ã¿ã‚ˆã†

ã“ã‚“ãªã¨ãã¯ã¡ã‚‡ã£ã¨ã®ã‚³ãƒ¼ãƒ‰ã§ã™ã’ãƒ¼å‹•ããƒªã‚µã‚¸ãƒ¥ãƒ¼çš„ãªã‚„ã¤ã«ã™ã‚‹ã¨æ±ºã¾ã£ã¦ã„ã¾ã™ã€‚

```ruby
require "bundler/setup"
Bundler.require(:default)

SDL2.init(SDL2::INIT_EVERYTHING)
window = SDL2::Window.create("(title)", SDL2::Window::POS_CENTERED, SDL2::Window::POS_CENTERED, 640, 480, 0)
window_flags = 0
window_flags |= SDL2::Renderer::Flags::ACCELERATED
window_flags |= SDL2::Renderer::Flags::PRESENTVSYNC
renderer = window.create_renderer(-1, window_flags)

include Math

counter = 0
loop do
  while ev = SDL2::Event.poll
    case ev
    when SDL2::Event::KeyDown
      case ev.scancode
      when SDL2::Key::Scan::ESCAPE
        exit
      when SDL2::Key::Scan::Q
        exit
      end
    end
  end

  renderer.draw_color = [0, 0, 64]
  renderer.clear

  renderer.draw_color = [0, 0, 255]

  w, h = window.size
  n = 24
  n.times do |i|
    a = PI * 2 / (n * 1.5) * i
    x = w / 2 + cos(a + PI * counter * 0.04 * 0.7) * w * 0.4
    y = h / 2 + sin(a + PI * counter * 0.04 * 0.8) * h * 0.4
    radius = 32
    renderer.draw_rect(SDL2::Rect.new(x - radius, y - radius, radius * 2, radius * 2))
  end

  renderer.present
  counter += 1
end
```

![lissajous](/images/7170a5dc60c97b/lissajous.png)

é™æ­¢ç”»ãªã®ã§ã‚ã‹ã‚Šã¾ã›ã‚“ãŒã¬ã‚‹ã¬ã‚‹å‹•ã„ã¦ã„ã¾ã™ã€‚

## ã“ã“ã¾ã§ã§ã‚ã‹ã£ãŸã“ã¨

- [rsdl](https://rubygems.org/gems/rsdl/versions/0.1.2?locale=ja) ãŒä¸è¦ã«ï¼ï¼Ÿ
  - Ruby/SDL æ™‚ä»£ã¯ ruby ã®ã‹ã‚ã‚Šã« rsdl ã§èµ·å‹•ã—ãªã„ã¨å‹•ã‹ãªã‹ã£ãŸ
  - ã‚ã‹ã£ã¦ã„ã¦ã‚‚ã“ã®ç½ ã«ã¯ã¾ã‚Šç¶šã‘ãŸ
- SGE ã¾ã§ä¸è¦ï¼ï¼Ÿ
  - Ruby/SDL æ™‚ä»£ã¯ SGE ã‚’åˆ¥é€”å…¥ã‚Œãªã„ã¨ã‚ãã«æç”»ã§ããªã‹ã£ãŸ
  - ã“ã® SGE ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒæ¿€ãƒ ã‚º
  - ãã®ã›ã„ã‹ Ruby/SDL æœ¬ä½“ã«ã“ã£ãã‚Šãƒãƒ³ãƒ‰ãƒ«ã•ã‚Œã¦ã„ã¦ãƒ“ãƒ«ãƒ‰ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã‚‹ã¨ä¸€ç·’ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ããŸ
- ä½¿ã„ã‚„ã™ããªã£ã¦ã„ã‚‹æ°—ãŒã™ã‚‹
  - draw_color ã§è‰²ã ã‘æŒ‡å®šã§ãã‚‹ã¨ã“ã‚ã¨ã‹
  - PRESENTVSYNC ã ã‘ã§å‚ç›´åŒæœŸã¨ã‹
- Nannou ã¨æ¯”ã¹ã‚‹ã¨
  - Escape ã§çµ‚äº†ã—ãªã„
  - é ˜åŸŸã‚’æ‰±ã†ä¾¿åˆ©ã‚¯ãƒ©ã‚¹ã‚„å¼·åŠ›ãªãƒ™ã‚¯ãƒˆãƒ«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãªã©ãŒãªã„
  - ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨ã—ã¦ã®æ›¸ãæ–¹ã‚‚æ±ºã¾ã£ã¦ãªã„
  - Ruby/SDL* ã¯ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨ã„ã†ã‚ˆã‚Šã¯ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°

## ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

