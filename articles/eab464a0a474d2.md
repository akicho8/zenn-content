---
title: "Panolens ã®ä½¿ã„æ–¹ãƒ¡ãƒ¢"
emoji: "ğŸ–¼"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Panolens", "ç”»åƒ", "VR"]
published: false
---

# PANOLENS.Viewer ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ #

https://pchen66.github.io/panolens.js/docs/Viewer.html

| Key                | Value         | æ„å‘³                                                        |
|--------------------|---------------|-------------------------------------------------------------|
| container          | document.body | æç”»ã™ã‚‹å ´æ‰€                                                |
| controlBar         | true          | å·¦ä¸‹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹ã‹ï¼Ÿ                            |
| controlButtons     | []            | å·¦ä¸‹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®é …ç›® ['fullscreen', 'setting', 'video'] |
| autoHideControlBar | true          | å·¦ä¸‹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒãƒ¼è‡ªå‹•éè¡¨ç¤ºã«ã™ã‚‹ (ã©ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ï¼Ÿ)   |
| autoHideInfospot   | true          | Infospotsã‚’è‡ªå‹•éè¡¨ç¤ºã«ã—ã¾ã™                               |
| horizontalView     | true          | æ°´å¹³ã‚«ãƒ¡ãƒ©åˆ¶å¾¡ã®ã¿è¨±å¯ã«ã™ã‚‹ (ä¸Šä¸‹ã®è§’åº¦ã‚’å¤‰ãˆã‚‰ã‚Œãªã„)     |
| cameraFov          | 100           | Field Of View (=è¦–é‡) 0:ç‹­ã„ 100:åºƒã„                       |
| reverseDragging    | true          | æ“ä½œã«å¯¾ã—ã¦ã®ã‚«ãƒ¡ãƒ©ç§»å‹•ã‚’é€†ã«ã™ã‚‹                          |
| viewIndicator      | false         | å·¦ä¸Šã«è¨ˆå™¨ã‚’è¿½åŠ  (?)                                        |
| indicatorSize      | 30            | å·¦ä¸Šã®è¨ˆå™¨ã‚µã‚¤ã‚º                                            |
| output             | "console"     | Infospotã®ä½ç½®ã‚’ console ã«è¡¨ç¤º                             |

##### ã‚¹ãƒãƒ›VRå‘ã‘ã®ç…§æº– #####

| Key               | Value | æ„å‘³                                                         |
|-------------------|-------|--------------------------------------------------------------|
| enableReticle     | true  | ç”»é¢ä¸­å¤®ã«ç™½ç‚¹ã‚’é…ç½®ã™ã‚‹(å¤§ãã•ã§ã‚«ãƒ¡ãƒ©ã¨ã®è·é›¢ãŒæŠŠæ¡ã§ãã‚‹) |
| dwellTime         | 1500  | ãã®ç™½ç‚¹ã«æŒ‡å®šmsãƒ’ãƒƒãƒˆã—ãŸã‚‰ 1500 = 1.5ç§’                    |
| autoReticleSelect | true  | è‡ªå‹•ã§é¸æŠã™ã‚‹                                               |

# ãƒ•ã‚¡ã‚¤ãƒ­ã‚»ãƒ³ã‚µãƒ¼å¯¾å¿œ #

```javascript
viewer.toggleNextControl()
```

# output ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ç¿»å¼„ã•ã‚ŒãŸä»¶ #

  * `output: "console"` ã«ã—ã¦ãŠãã¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ã„ã‚‹é–“ã ã‘ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ä½ç½®ã‚’è¡¨ç¤ºã—ã¦ãã‚Œã‚‹
  * è¦ã¯ãã‚Œã‚’è¦‹ã¦ Infospot ã‚’ç™»éŒ²ã™ã‚‹ã¨ãã«ä½¿ã£ã¦ã­ã€ã¨ã„ã†æ„å›³ã§ä½œè€…ãŒå…¥ã‚Œã¦ãã‚Œã¦ã„ã‚‹ã‚“ã ã¨æ€ã‚ã‚Œã‚‹
  * ãã‚Œã§æ¸ˆã‚€äººã«ã¨ã£ã¦ã¯ã€ã‚ã‚Šã¨æœ‰ç”¨ã ã¨æ€ã†
  * ã—ã‹ã—ã€åˆ©ç”¨è€…ãŒã¨ã„ã†ã‹ç§ãŒæœ¬å½“ã«æœ›ã‚“ã§ã„ã‚‹æ©Ÿèƒ½ã¯ã€ã‚¯ãƒªãƒƒã‚¯ã—ãŸãƒ¯ãƒ¼ãƒ«ãƒ‰åº§æ¨™ã‚’**ã‚¤ãƒ™ãƒ³ãƒˆ**ã§è¿”ã—ã¦ãã‚Œã‚‹æ©Ÿèƒ½ã ã£ãŸ
  * ãªã‚“ã¨ã‹ãªã‚“ãªã„ã®ã‹ã¨ GitHub ã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã¿ã‚‹ã¨ `output: "event"` ã«ã™ã‚‹ã¨ `position-output` ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã§åº§æ¨™ã‚’é€ã£ã¦ãã‚Œã‚‹æ©Ÿèƒ½ãŒã‚ã£ãŸ (å…¬é–‹ã•ã‚Œã¦ã‚‹ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã«ã¯è¼‰ã£ã¦ãªã„)
  * ã“ã‚ŒãŒæ¬²ã—ã‹ã£ãŸã‚“ã ã¨ã„ã†æ€ã„ã§ä½¿ã£ã¦ã¿ãŸã‚‰ãƒã‚¦ã‚¹ã‚’å‹•ã‹ã™ãŸã³ã«ç™ºç”Ÿã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã ã£ãŸ

# ã‚¯ãƒªãƒƒã‚¯ã—ãŸåº§æ¨™ã‚’æ±‚ã‚ã‚‹ #

ã‚ã‚ŠãŒãŸã„ã“ã¨ã«çµ„ã¿è¾¼ã¿ã®ä¸–ç•Œã¨é•ã£ã¦WEBã®ä¸–ç•Œã¯è‡ªåˆ†ãŒå›°ã£ã¦ã„ã‚‹ã“ã¨ã¯ä»–ã®äººã‚‚å›°ã£ã¦ã„ã‚‹ã®ã§ã€ã¨ãã«æ¯ã‚ŒãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å ´åˆã€ã ã„ãŸã„ã‚°ã‚°ã‚Œã°è§£æ±ºç­–ãŒå‡ºã¦ãã‚‹
ãã“ã§è¦‹ã¤ã‘ãŸã“ã¡ã‚‰ã® Issue ã«ã‚ˆã‚‹ã¨

https://github.com/pchen66/panolens.js/issues/160

è‡ªåŠ›ã§æ›¸ã‘ã¨ã„ã†ã“ã¨ã ã£ãŸ

https://github.com/pchen66/panolens.js/blob/c90ffbc3f989b60196adc02f4ecf420e54f87528/src/viewer/Viewer.js#L1298

æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã® `output: "console"` ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’å…ƒã«ã™ã‚‹ã¨ã“ã‚Œã§è‰¯ã„ã¿ãŸã„

```javascript
import * as THREE from "three"

panorama.addEventListener("click", e => {
  const intersects = viewer.raycaster.intersectObject(viewer.panorama, true)
  if (intersects.length > 0) {
    const point = intersects[0].point.clone() // => Vector3 {x: 2572.0764633107765, y: 1892.102225883789, z: -3839.4888925916653}
    const converter = new THREE.Vector3(-1, 1, 1)
    const world = viewer.panorama.getWorldPosition(new THREE.Vector3())
    point.sub(world).multiply(converter)
    console.log(point)                        // => Vector3 {x: -2572.0764633107765, y: 1892.102225883789, z: -3839.4888925916653}
  }
})
```

# å‚ç…§ #

https://github.com/pchen66/panolens.js
https://pchen66.github.io/panolens.js/docs/
https://studio-amelie.com/development/panolens-onclick-add-infospot
