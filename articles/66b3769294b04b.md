---
title: "Emacsã‹ã‚‰Zennã‚’ä½¿ã„ã‚„ã™ãã—ã¦ã¿ãŸ"
emoji: "ğŸ¬"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Emacs", "Zenn", "transient", "helm"]
published: true
---

Zenn ã¯ zenn-cli ãŒã‚ã‚‹ãŠã‹ã’ã§ã¨ã¦ã‚‚è¨˜äº‹ãŒæ›¸ãã‚„ã™ã„ã§ã™
ãŸã æ…£ã‚Œã¦ãã‚‹ã¨ã¡ã‚‡ã£ã¨ã—ãŸä¸€æ‰‹é–“ãŒé¢å€’ã«ãªã£ã¦ãã¾ã™
ãŸã¨ãˆã° Typo ã‚’ä¿®æ­£ã—ãŸã„ã¨ã

  1. è¨˜äº‹ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã™ã‚‹
  2. è©²å½“ã® Markdown ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¢ã™ (ãƒ•ã‚¡ã‚¤ãƒ«åã‹ã‚‰ã¯æ¨æ¸¬ã¤ã‹ãªã„)
  3. ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’èµ·å‹•ã™ã‚‹ (ã™ã§ã«èµ·å‹•ã—ã¦ã‚‹ã®ã«ã¾ãŸèµ·å‹•ã—ã¡ã‚ƒã£ãŸã‚Š)
  4. ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰è©²å½“ã®è¨˜äº‹ã‚’ã¾ãŸæ¢ã™ (ã ã„ãŸã„ã„ã¡ã°ã‚“ä¸Šã«ã‚ã‚‹ã‘ã©)

ã¨ãªã£ã¦ã¾ãšãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¢ã™ã®ã§ç–²ã‚Œã¦ã‚‚ã†ç¢ºèªã¯ã„ã„ã‹ã‚‰ãƒ—ãƒƒã‚·ãƒ¥ã—ã¡ã‚ƒãˆã¨ãªã‚ŠãŒã¡ã§ã—ãŸ
ãªã®ã§ Emacs ã‹ã‚‰ã‚ˆã‚Šç°¡å˜ã«ä½¿ãˆã‚‹ã‚ˆã†ã«ã—ã¦ã¿ã¾ã—ãŸ

ã©ã“ã‹ã‚‰ã§ã‚‚ã„ã„ã®ã§ `C-j z` ã‚’ã‚¿ã‚¤ãƒ—ã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ã«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒå‡ºã¾ã™

![](/images/66b3769294b04b/emacs_ss1.png)
*ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’èµ·å‹•ã—ãŸã¨ã“ã‚*

ã‚ã¨ã¯ã‚„ã‚ŠãŸã„ã“ã¨ã‚’é©å½“ã«é¸æŠã™ã‚‹ã ã‘ã§ã™

### s æ¤œç´¢ ###

![](/images/66b3769294b04b/emacs_ss2.png)
*s ã®ã‚ã¨ rust ã¨å…¥åŠ›ã—ãŸã¨ã“ã‚*

  * [helm-ag](https://github.com/emacsorphanage/helm-ag) ã‚’ä½¿ã£ã¦ `title:` ã§çµã‚Šè¾¼ã‚“ã çŠ¶æ…‹ã§èµ·å‹•ã™ã‚‹
  * ãã®ã¾ã¾é¸ã‚“ã§ã‚‚ã„ã„ã—ã€ã•ã‚‰ã«çµã‚Šè¾¼ã‚“ã§ã‚‚ã„ã„

### n æ–°è¦è¨˜äº‹ ###

  * `zenn new:article` ã‚’å®Ÿè¡Œã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã

### o æœ¬å®¶ã§è¡¨ç¤º ###

  * é–‹ã„ã¦ã„ã‚‹ Markdown ãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾å¿œã™ã‚‹æœ¬å®¶ã®URLã‚’é–‹ã

### p ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ ###

  * é–‹ã„ã¦ã„ã‚‹ Markdown ãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾å¿œã™ã‚‹ãƒ­ãƒ¼ã‚«ãƒ«ã®URLã‚’ç›´æ¥é–‹ã
  * ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã®ã‚µãƒ¼ãƒ“ã‚¹ãŒèµ·å‹•ã—ã¦ãªã‹ã£ãŸã‚‰å‹æ‰‹ã«èµ·å‹•ã•ã›ã‚‹

### u ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ›´æ–° ###

  * `npm install zenn-cli@latest` ã‚’å®Ÿè¡Œã™ã‚‹
  * æ›´æ–°ã›ã„ã¨è¨€ã‚ã‚ŒãŸã¨ãç”¨

# ã‚³ãƒ¼ãƒ‰ #

```emacs-lisp
(require 'transient)
(require 'helm-ag)
(require 'f)

(transient-define-suffix my-zenn-search ()
  :key "s"
  :description "æ¤œç´¢"
  (interactive)
  (helm-do-ag "~/src/zenn-content" nil "title: "))

(transient-define-suffix my-zenn-article-new ()
  :key "n"
  :description "æ–°è¦è¨˜äº‹"
  (interactive)
  (let ((slug (shell-command-to-string "ruby -r securerandom -e 'SecureRandom.hex(7).display'")))
    (shell-command (format "cd ~/src/zenn-content && zenn new:article --slug %s" slug))
    (find-file (format "~/src/zenn-content/articles/%s.md" slug))
    (end-of-buffer)))

(transient-define-suffix my-zenn-current-open ()
  :key "o"
  :description "æœ¬å®¶ã§è¡¨ç¤º"
  (interactive)
  (let* ((stem (f-base buffer-file-name))
         (url (format "https://zenn.dev/megeton/articles/%s" stem)))
    (shell-command (format "open %s" url))))

(transient-define-suffix my-zenn-current-preview ()
  :key "p"
  :description "ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼"
  (interactive)
  (let* ((stem (f-base buffer-file-name))
         (url (format "http://localhost:8001/articles/%s" stem)))
    (my-zenn-preview-start)
    (shell-command (format "open %s" url))))

(transient-define-suffix my-zenn-preview-start ()
  :key "1"
  :description "ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼èµ·å‹•"
  (interactive)
  (when (not (process-status "zenn"))
    (start-process-shell-command "zenn" "*Zenn*" "cd ~/src/zenn-content && zenn preview --open -p 8001")))

(transient-define-suffix my-zenn-preview-stop ()
  :key "0"
  :description "ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼åœæ­¢"
  (interactive)
  (when (process-status "zenn")
    (delete-process "zenn")))

(transient-define-suffix my-zenn-update ()
  :key "u"
  :description "ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ›´æ–°"
  (interactive)
  (async-shell-command "cd ~/src/zenn-content && npm install zenn-cli@latest"))

(transient-define-prefix my-zenn-menu ()
  "Zenn"
  [["Basic"
    (my-zenn-search)
    (my-zenn-article-new)
    (my-zenn-current-open)]
   ["Preview"
    (my-zenn-current-preview)
    (my-zenn-preview-start)
    (my-zenn-preview-stop)]
   ["Other"
    (my-zenn-update)]])

;; (global-set-key (kbd "C-j z") 'my-zenn-menu)
```
