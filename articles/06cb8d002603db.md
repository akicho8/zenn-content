---
title: "transient.el ã‚’ä½¿ã„ã“ãªã—ãŸã„"
emoji: "ğŸ¡"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Emacs", "Transient"]
published: true
---

# ã¯ã˜ã‚ã« #

transient.el ã¯ Magit ã§ä½¿ã‚ã‚Œã¦ã„ã‚‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤ºç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™
Magit ã¯ Emacs ã‹ã‚‰ Git ã‚’ç°¡å˜ã«æ‰±ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã™

æœ¬æ–‡ã«å‡ºã¦ãã‚‹ `c1` `c2` `c3` ã¯ä½•ã‹ã®é–¢æ•°ã§ã™
æ¬¡ã®ã‚ˆã†ãªã®ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã«ã—ã¾ã™

```emacs-lisp
(defun c1() (interactive) (message "c1"))
(defun c2() (interactive) (message "c2"))
(defun c3() (interactive) (message "c3"))
```

# ä¸€å¼å…¥ã£ã¦ã‚‹ã„ã¡ã°ã‚“ç°¡å˜ãªä¾‹ #

```emacs-lisp
(require 'transient)

(transient-define-prefix f1 ()
  [("h" "Hello" (lambda () (interactive) (message "ã“ã‚“ã«ã¡ã¯")))])

(global-set-key (kbd "C-c RET") 'f1)
```
```text
 h Hello
```

- `M-x f1` ã¾ãŸã¯ `C-c RET` ã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒèµ·å‹•ã™ã‚‹
- `h` ã§ lambda ãƒ–ãƒ­ãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹

# description ã‚’å…¥ã‚Œã‚‹ #

`"ã‚³ãƒãƒ³ãƒ‰"` ã®éƒ¨åˆ†ã®ã“ã¨ã€‚ãªãã¦ã‚‚ã„ã„ã‘ã©ã‚ã‚‹ã¨ã‚ã‹ã‚Šã‚„ã™ã„ã€‚

```emacs-lisp
(transient-define-prefix f1 ()
  ["ã‚³ãƒãƒ³ãƒ‰" ("h" "Hello" (lambda () (interactive) (message "ã“ã‚“ã«ã¡ã¯")))])
```

```text
ã‚³ãƒãƒ³ãƒ‰
 h Hello
```

# æŒ‡å®šã®é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ #

```emacs-lisp
(transient-define-prefix f1 ()
  [("a" "item1" c1)])
```

- lambda ã®ã‹ã‚ã‚Šã«é–¢æ•°ã‚’æŒ‡å®šã™ã‚‹
- `a item1` ã¨è¡¨ç¤ºã•ã‚Œ `a` ã§ `c1` ã‚’å®Ÿè¡Œã™ã‚‹

# é–¢æ•°ã‚’è¤‡æ•°æŒ‡å®šã™ã‚‹ #

```emacs-lisp
(transient-define-prefix f1 ()
  [
   ("a" "item1" c1)
   ("b" "item2" c2)
   ])
```

è¤‡æ•°æ›¸ãã¨**ç¸¦**ã«ãªã‚‰ã¶

```text
a item1
b item2
```

# å®Ÿè¡Œã—ã¦ã‚‚ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‰ã˜ãªã„ã‚ˆã†ã«ã™ã‚‹ #

```emacs-lisp
(transient-define-prefix f1 ()
  [
   ("a" "item1" c1 :transient t)
   ])
```

- `:transient t` ã§ `a` ã‚’æŠ¼ã—ã¦ã‚‚ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒé–‰ã˜ãªããªã‚‹
- ä½•å›ã‹é€£ç¶šã§å®Ÿè¡Œã™ã‚‹ã‚ˆã†ãªé–¢æ•°ã«æŒ‡å®šã™ã‚‹
- `C-q` `C-g` `ESC ESC ESC` ã®ã©ã‚Œã‹ã§é–‰ã˜ã‚‹

# é–¢æ•°ã®æ–¹ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ›¸ã„ã¦ã‚‚ã„ã„ #

`defun` ã®ã‹ã‚ã‚Šã« `transient-define-suffix` ã‚’ä½¿ã†ã¨é–¢æ•°å´ã§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ›¸ã‘ã‚‹

```emacs-lisp
(transient-define-suffix c1 ()
  :key "a"
  :description "item1"
  :transient t
  (interactive)
  (message "c1"))
```

ã“ã‚Œã§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®æ–¹ã«ã¯é–¢æ•°ã‚’ä¸¦ã¹ã‚‹ã ã‘ã§ã‚ˆããªã‚‹

```emacs-lisp
(transient-define-prefix f1 ()
  [(c1)])
```

è¨­å®šã¯ä¸Šæ›¸ãã§ãã‚‹

```emacs-lisp
(transient-define-prefix f1 ()
  [(c1 :key "b")])
```

æ™®é€šã®é–¢æ•°ã ã£ãŸã‹ã®ã‚ˆã†ã«æ›¸ã„ã¦ã‚‚ã„ã„

```emacs-lisp
(transient-define-prefix f1 ()
  [("b" "item2" c1)])
```

# ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ #

ã“ã‚Œã‚’é ­ã§ç†è§£ã™ã‚‹ã®ã¯é›£ã—ã„

## ã€Œé…åˆ—ã€ã‚’ä¸¦ã¹ã‚‹ã¨ä¸‹æ–¹å‘ã«å¢—ãˆã‚‹ ##

```emacs-lisp
(transient-define-prefix f1 ()
  ["ä¸Š" (a) (b)]
  ["ä¸‹" (c) (d)])
```
```text
ä¸Š
 a
 b
ä¸‹
 c
 d
```

## ã€Œé…åˆ—ã®é…åˆ—ã€ãªã‚‰å³æ–¹å‘ã«å¢—ãˆã‚‹ ##

```emacs-lisp
(transient-define-prefix f1 ()
  [["å·¦" (a) (b)]["å³" (c) (d)]])
```
```text
å·¦    å³
 a     c
 b     d
```

## ã€Œé…åˆ—ã®é…åˆ—ã€ã‚’ä¸¦ã¹ã‚‹ã¨ãã‚ŒãŒä¸‹æ–¹å‘ã«å¢—ãˆã‚‹ ##

```emacs-lisp
(transient-define-prefix f1 ()
  ["ä¸Š" ["å·¦ä¸Š" (a) (b)] ["å³ä¸Š" (c) (d)]]
  ["ä¸‹" ["å·¦ä¸‹" (a) (b)] ["å³ä¸‹" (c) (d)]])
```
```text
å·¦ä¸Š    å³ä¸Š
  a       c
  b       d
å·¦ä¸‹    å³ä¸‹
  a       c
  b       d
```

# description ã¯å‹•çš„ã«ç”Ÿæˆã§ãã‚‹ #

  * æ¬¡ã®2ã¤ã¯åŒã˜
  * ã“ã‚ŒãŒå½¹ç«‹ã£ãŸã“ã¨ã¯ã„ã¾ã®ã¨ã“ã‚ãªã„

```emacs-lisp
(transient-define-prefix f1 ()
  ["ä¸Š" (c1)])
```

```emacs-lisp
(transient-define-prefix f1 ()
  [:description (lambda () "ä¸Š") (c1)])
```

# å¼•æ•°ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒ³ #

## åŸºæœ¬å½¢ ##

```emacs-lisp
(transient-define-prefix f1 ()
  ["ã‚ªãƒ—ã‚·ãƒ§ãƒ³" ("-x" "è«–ç†å‹" "--xxx")]
  ["ã‚³ãƒãƒ³ãƒ‰" ("a" "item1" (lambda () (interactive) (prin1 (transient-args 'f1))))])
```

```text
ã‚ªãƒ—ã‚·ãƒ§ãƒ³
 -x è«–ç†å‹ (--xxx)

ã‚³ãƒãƒ³ãƒ‰
 a item1
```

  * ã™ãã« `a` ã‚’ã‚¿ã‚¤ãƒ—ã™ã‚‹ã¨ `nil` ã‚’è¡¨ç¤ºã™ã‚‹
  * `-x` ã‚’ã‚¿ã‚¤ãƒ—ã™ã‚‹ã¨ `--xxx` ãŒæœ‰åŠ¹ã«ãªã‚‹ (è‰²ãŒå°‘ã—å¤‰ã‚ã‚‹)
  * `--xxx` ã‚’æœ‰åŠ¹ã«ã—ã¦ã‹ã‚‰ `a` ã‚’ã‚¿ã‚¤ãƒ—ã™ã‚‹ã¨ `("--xxx")` ã‚’è¡¨ç¤ºã™ã‚‹
  * `(transient-args 'f1)` ãŒã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®**é…åˆ—**ã‚’è¿”ã—ã¦ã„ã‚‹
    * å¼•æ•°ã® `f1` ã®éƒ¨åˆ†ã¯å¯¾è±¡ã®é–¢æ•°å
    * ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒãªã„ã¨ãã¯ `nil` ã«ãªã‚‹ (ç©ºé…åˆ—ã§ã¯ãªã)
      * ãŒã€ãã‚ŒãŒå•é¡Œã«ãªã‚‹ã“ã¨ã¯ã¨ãã«ãªã„
  * `-x` ã®éƒ¨åˆ†ã¯ãƒã‚¤ãƒ•ãƒ³ã§å§‹ã‚ãªãã¦ã‚‚ã„ã„
    * `x` ã¨ã™ã‚Œã° `x` ã§ãƒˆã‚°ãƒ«ã§ãã‚‹
    * ã—ã‹ã—ã‚³ãƒãƒ³ãƒ‰è¦‹é–“é•ã†ã®ã§ `-` ã§å§‹ã‚ãŸæ–¹ãŒã„ã„
  * `"ã‚ªãƒ—ã‚·ãƒ§ãƒ³"` ã¨ `"ã‚³ãƒãƒ³ãƒ‰"` ã¯ç„¡ãã¦ã‚‚ã„ã„ã‘ã©ã‚ã‚‹ã¨ã‚ã‹ã‚Šã‚„ã™ã„
  * ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ã‚³ãƒãƒ³ãƒ‰ã‚’ã©ã“ã«æ›¸ãã‹æ±ºã¾ã‚Šã¯ãªã„
    * é…åˆ—å†…è¦ç´ ã®3ã¤ç›®ãŒé–¢æ•°ã‹ã©ã†ã‹ã§è¦‹åˆ†ã‘ã¦ã„ã‚‹ã¿ãŸã„
    * ã ã‹ã‚‰ã‚ªãƒ—ã‚·ãƒ§ãƒ³é¡ã¯ä¸‹ã«é…ç½®ã—ã¦ã‚‚ã„ã„

## åˆæœŸå€¤ã‚’æŒ‡å®šã™ã‚‹ ##

```emacs-lisp
(transient-define-prefix f1 ()
  :value '("--xxx")
  ["ã‚ªãƒ—ã‚·ãƒ§ãƒ³" ("-x" "è«–ç†å‹" "--xxx")]
  ["ã‚³ãƒãƒ³ãƒ‰" ("a" "item1" (lambda () (interactive) (prin1 (transient-args 'f1))))])
```

  * `:value` ã§åˆæœŸå€¤ã‚’æŒ‡å®šã™ã‚‹
  * ä¸Šã®ä¾‹ã§ã¯ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’èµ·å‹•ã—ãŸæ™‚ç‚¹ã§ `--xxx` ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ (è‰²ãŒã¤ã„ã¦ã„ã‚‹)

## ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æ°¸ç¶šåŒ–ã™ã‚‹ ##

`C-x` ã‚’æŠ¼ã™ã¨ã“ã†ãªã‚‹ã®ã§

![](/images/06cb8d002603db/emacs_ss1.png)
*C-x ã‚’æŠ¼ã—ãŸã¨ã“ã‚*

ç¶šã‘ã¦ `C-s` ã™ã‚‹ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã™ã‚‹

```emacs-lisp:~/.emacs.d/transient/values.el
((f1 "--xxx"))
```

ã‚ˆãä½¿ã†ã‹ã‚‚ã—ã‚Œãªã„æ“ä½œã¾ã¨ã‚

| æ“ä½œ      | æ„å‘³           | å‚™è€ƒ                    |
|-----------|----------------|-------------------------|
| `C-x C-s` | ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ | æ°¸ç¶šåŒ–                  |
| `C-x s`   | ãƒ¡ãƒ¢ãƒªã«ä¿å­˜   | Emacsã‚’é–‰ã˜ãŸã‚‰å…ƒã«æˆ»ã‚‹ |
| `C-x C-k` | åˆæœŸå€¤ã«æˆ»ã™   |                         |

## æ–‡å­—åˆ—å‹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ ##

`--xxx` ã‚’ `--xxx=` ã«å¤‰æ›´ã™ã‚‹

```emacs-lisp
(transient-define-prefix f1 ()
  ["ã‚ªãƒ—ã‚·ãƒ§ãƒ³" ("-x" "æ–‡å­—åˆ—å‹" "--xxx=")]
  ["ã‚³ãƒãƒ³ãƒ‰" ("a" "item1" (lambda () (interactive) (prin1 (transient-args 'f1))))])
```

  * `-x` ã‚’ã‚¿ã‚¤ãƒ—ã™ã‚‹ã¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒå‡ºã‚‹
  * `foo` ã¨å…¥åŠ›ã™ã‚‹ã¨ `--xxx=foo` ã¨è¡¨ç¤ºãŒå¤‰ã‚ã‚‹
  * ãã®å¾Œã§ `a` ã‚’ã‚¿ã‚¤ãƒ—ã™ã‚‹ã¨ `("--xxx=foo")` ã‚’è¡¨ç¤ºã™ã‚‹
  * è«–ç†å‹ã¨åŒæ§˜ã«åˆæœŸå€¤ã‚’æ›¸ã‘ã‚‹ã€‚ä¾‹: `:value '("--xxx=foo")`

## ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å€¤ã‚’å–ã‚Šå‡ºã™ ##

æ±ç”¨ã® `transient-arg-value` ã§é…åˆ—ã‹ã‚‰ç‰¹å®šã®å€¤ã ã‘ã‚’ãˆãˆæ„Ÿã˜ã«å–ã‚Šå‡ºã›ã‚‹

ãã‚Œãã‚Œè«–ç†å‹ã¨æ–‡å­—åˆ—å‹ã®ä¾‹

```emacs-lisp
(transient-arg-value "--xxx" '("--xxx"))      ; => t
(transient-arg-value "--xxx=" '("--xxx=foo")) ; => "foo"
```

ã¨ãªã‚‹ã®ã§ç¬¬äºŒå¼•æ•°ã«ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®é…åˆ— `(transient-args 'f1)` ã‚’æ¸¡ã™

```emacs-lisp
(transient-args 'f1)                                ; => ("--xxx=foo")
(transient-arg-value "--xxx=" (transient-args 'f1)) ; => "foo"
```

## æ–‡å­—åˆ—å‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã® `=` ã®æœ‰ç„¡ã¯ã‹ãªã‚Šé‡è¦ ##

  * `--xxx=foo` ã§ã¯ãªã `--xxx foo` ã¨ã—ã¦ã—ã¾ã†ã¨å€¤ã‚’ã‚’å–ã‚Šå‡ºã›ãªã„
  * ç´ ç›´ã« `--xxx=foo` ã¨ãªã‚‹ã‚ˆã†ã«ã™ã‚‹

```emacs-lisp
(transient-arg-value "--xxx " '("--xxx foo")) ; => nil
```

## ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‹ã‚‰å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ã®çµ„ã¿ç«‹ã¦ ##

ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®æŒãæ–¹ã¯ã•ã¾ã–ã¾ã ã‘ã©å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ã®ä»•æ§˜ã¨ä¸€è‡´ã—ã¦ã„ã‚‹å ´åˆã¯å††æ»‘ã«æ¸¡ã›ã‚‹

ãã®ã¾ã¾ `git` ã®å¼•æ•°ã¨ã™ã‚‹ä¾‹:

```emacs-lisp
(require 's)
(shell-command (s-join " " (cons "git" (transient-args 'f1))))
```

`(transient-args 'f1)` ãŒ `("--version")` ã ã¨ã™ã‚Œã° `git --version` ã‚’å®Ÿè¡Œã™ã‚‹

# è¡¨ç¤ºæ¡ä»¶ #

```emacs-lisp
(transient-define-prefix f1 ()
  [
    :if (lambda () t)
    ("a" "item1" c1 :if (lambda () t))
   ])
```

  * é…åˆ—ã®å…ˆé ­ã«æ›¸ãã¨é…åˆ—è¦ç´ å…¨ä½“ã«é©ç”¨ã™ã‚‹
  * å€‹åˆ¥ã«æŒ‡å®šã—ã¦ã‚‚ã‚ˆã„
  * ã„ã‚ã‚“ãªæ¡ä»¶æ§‹æ–‡ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹
    * `if` `if-not` `if-non-nil` `if-nil` `if-mode` `if-not-mode` `if-derived` `if-not-derived` 
  * `if-derived` ã¯ `derived-mode-p` ã§åˆ¤å®šã™ã‚‹
  * `:if-mode (ruby-mode rust-mode)` ã®ã‚ˆã†ã«è¤‡æ•°æŒ‡å®šã—ã¦ã‚‚ã‚ˆã„

# æ—¥æœ¬èªã®å•é¡Œ #

åˆ—ã§è¡¨ç¤ºã™ã‚‹ã¨ãé …ç›®åãŒæ—¥æœ¬èªã ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹å ´åˆãŒã‚ã‚‹
ãã‚“ãªã¨ãã¯ `:variable-pitch t` ã§å›é¿ã§ãã‚‹

```emacs-lisp
(transient-define-prefix f1 ()
  :variable-pitch t
  [
   [("a" "ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰" c1)]
   [("b" "ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—" c2)]
   ])
```

æ¯å›æŒ‡å®šã™ã‚‹ã®ã¯é¢å€’ãªã®ã§ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªè¨­å®šã¨ã—ãŸæ–¹ãŒã‚ˆã•ãã†

```emacs-lisp
(setq transient-align-variable-pitch t)
```

æ¬¡ã®**å›ºå®šå¹…ãƒ•ã‚©ãƒ³ãƒˆä½¿ã†**ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹ã«ã—ã¦ã‚‚å›é¿ã§ãã‚‹

```emacs-lisp
(setq transient-force-fixed-pitch t)
```

ã—ã‹ã—æ–‡å­—ã«éš™é–“ãŒç©ºã„ã¦å¤ã‚ã‹ã—ã„æ„Ÿã˜ã®è¦‹ãŸç›®ã«ãªã£ã¦ã—ã¾ã†ã®ã§æœ€åˆã®ã§ååˆ†ã ã¨æ€ã†

# å®Ÿç”¨ç·¨ #

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹• ##

```emacs-lisp
(transient-define-prefix f1 ()
  "ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹•"
  ["ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹•"
   ("l" "ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰" (lambda () (interactive) (dired "~/Downloads")))
   ("t" "ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—" (lambda () (interactive) (dired "~/Desktop")))
   ("d" "æ›¸é¡"         (lambda () (interactive) (dired "~/Documents")))
   ("i" "ç”»åƒ"         (lambda () (interactive) (dired "~/Pictures")))
   ("x" "Dropbox"      (lambda () (interactive) (dired "~/Dropbox")))
   ("~" "Home"         (lambda () (interactive) (dired "~/")))
   ("s" "src"          (lambda () (interactive) (dired "~/src")))
   ("g" "gems"         (lambda () (interactive) (dired "/usr/local/var/rbenv/versions/3.1.0/lib/ruby/gems/3.1.0/gems")))
   ("z" "Zenn"         (lambda () (interactive) (dired "~/src/zenn-content/articles")))
   ("c" "Cargo"        (lambda () (interactive) (dired "~/.cargo/registry/src")))
   ("e" "Emacs"        (lambda () (interactive) (dired "~/.emacs.d")))
   ])
```

ã“ã†ã‚„ã£ã¦ç§»å‹•ã™ã‚Œã°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé–“ã®è·é›¢ã®æ„Ÿè¦šã¯ãªããªã£ã¦ã„ã

## Railsã‚¢ãƒ—ãƒªå†…ã§ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹• ##

`.git` ã®è¦ªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ã®ç›¸å¯¾çš„ãªç§»å‹•ã®ä¾‹

```emacs-lisp
(transient-define-prefix f1 ()
  "Railsã‚¢ãƒ—ãƒªå†…ã®è¦å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã™ã‚‹"
  ["ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹•"
   ("l" "log"        (lambda () (interactive) (my-chdir-from-git-root "log")))
   ("m" "model"      (lambda () (interactive) (my-chdir-from-git-root "app/models")))
   ("c" "controller" (lambda () (interactive) (my-chdir-from-git-root "app/controllers")))
   ("t" "test"       (lambda () (interactive) (my-chdir-from-git-root "spec")))
   ])

(defun my-chdir-from-git-root (dir)
  "ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹•(.gitã®è¦ªã‹ã‚‰ç›¸å¯¾çš„ã«)"
  (interactive)
  (dired
   (concat
    (locate-dominating-file default-directory ".git")
    dir)))
```

### å…¥åŠ›ãŒãƒãƒƒãƒ†ã‚£ãƒ³ã‚°ã—ãŸã‚‰ã©ã†ã™ã‚‹ï¼Ÿ ###

ä»®ã«æœ€åˆã«ã¤ãã£ãŸæ–¹ã¨æ··ãœãŸã¨ã™ã‚‹ã¨ `l` ãŒä¸¡æ–¹ã«ã‚ã‚‹ã®ã§å¹²æ¸‰ã—ã¦ã—ã¾ã†
ãã†ã„ã†å ´åˆã¯ç‰‡æ–¹ã‚’2æ–‡å­—ã«ã™ã‚‹æ‰‹ã‚‚ã‚ã‚‹

```emacs-lisp
(transient-define-prefix f1 ()
  ["ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç§»å‹•"
   ("l" "ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰" (lambda () (interactive) (dired "~/Downloads")))
   ("rl" "log"         (lambda () (interactive) (my-chdir-from-git-root "log")))
   ])
```

ãŸã  Magit ã§ã“ã®ã‚ˆã†ãªå®šç¾©ã¯è¦‹ãŸã“ã¨ãŒãªã„
å¾¹åº•ã—ã¦1æ–‡å­—ã«ã“ã ã‚ã£ã¦ã„ã‚‹ã—ã€ãã®æ–¹ãŒã„ã„ã¨æ€ã†

# å‚ç…§ #

https://github.com/magit/transient/wiki/Developer%20Quick%20Start%20Guide
https://magit.vc/manual/transient.html
https://github.com/magit/transient
